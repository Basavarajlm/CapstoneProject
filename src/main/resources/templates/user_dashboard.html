<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>User Dashboard</title>
</head>
<body>
    <h1>Welcome, <span th:text="${currentUser.name}"></span></h1>

    <!-- Add Skill Section -->
    <h2>Add Skill</h2>
    <form action="/dashboard/add-skill" method="post" th:object="${skillDTO}">
        <label for="domain">Choose Domain:</label>
        <select name="domain" id="domain">
            <option th:each="domain : ${allDomains}" th:value="${domain}" th:text="${domain}">Domain</option>
        </select>
        <label for="subdomain">Choose Subdomain:</label>
        <select name="subdomain" id="subdomain">
            <option th:each="subdomain : ${allSubdomains}" th:value="${subdomain}" th:text="${subdomain}">Subdomain</option>
        </select>
        <label for="skillName">Choose Skill:</label>
        <select name="skillName" id="skillName">
            <option th:each="skill : ${allSkills}" th:value="${skill.skillname}" th:text="${skill.skillname}">Skill</option>
        </select>
        <label for="proficiency">Proficiency:</label>
        <select name="proficiency" id="proficiency">
            <option value="Beginner">Beginner</option>
            <option value="Intermediate">Intermediate</option>
            <option value="Advanced">Advanced</option>
        </select>
        <label for="certificationName">Certification Name:</label>
        <input type="text" name="certificationName" id="certificationName">
        <button type="submit">Add Skill</button>
    </form>

    <!-- JavaScript to populate dynamic dropdowns and handle form submission -->
    <script th:inline="javascript">
        var domains = /*[[${allDomains}]]*/ [];
        var subdomains = /*[[${allSubdomains}]]*/ [];
        var skills = /*[[${allSkills}]]*/ [];

        var domainSelect = document.getElementById('domain');
        var subdomainSelect = document.getElementById('subdomain');
        var skillSelect = document.getElementById('skillName');

        // Populate domains dropdown
        domains.forEach(function(domain) {
            var option = document.createElement('option');
            option.value = domain;
            option.textContent = domain;
            domainSelect.appendChild(option);
        });

        // Populate subdomains dropdown based on domain selection
        domainSelect.addEventListener('change', function() {
            subdomainSelect.innerHTML = ''; // Clear subdomain dropdown
            var selectedDomain = this.value;
            subdomains.forEach(function(subdomain) {
                if (subdomain.domain === selectedDomain) {
                    var option = document.createElement('option');
                    option.value = subdomain.subdomain;
                    option.textContent = subdomain.subdomain;
                    subdomainSelect.appendChild(option);
                }
            });
        });

        // Populate skills dropdown based on subdomain selection
        subdomainSelect.addEventListener('change', function() {
            skillSelect.innerHTML = ''; // Clear skill dropdown
            var selectedSubdomain = this.value;
            skills.forEach(function(skill) {
                if (skill.subdomain === selectedSubdomain) {
                    var option = document.createElement('option');
                    option.value = skill.skillname;
                    option.textContent = skill.skillname;
                    skillSelect.appendChild(option);
                }
            });
        });
    </script>
</body>
</html>
